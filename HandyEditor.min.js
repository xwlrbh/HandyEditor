/**
 * Project: HandyEditor.
 * Author: A.J <804644245@qq.com>
 * Copyright: http://www.catfish-cms.com All rights reserved.
 * Version: 1.0.2
 */
!function(){window.HE={config:{width:"100%",height:"380px",lang:"zh-jian",skin:"HandyEditor",autoFloat:!1,topOffset:0,autoHeight:!1,item:["bold","italic","strike","underline","fontSize","fontName","color","backColor","|","center","left","right","full","indent","outdent","|","link","unlink","textBlock","selectAll","removeFormat","trash","|","image","subscript","superscript","horizontal","orderedList","unorderedList","|","undo","redo","|","about"]},define:{version:"1.0.2",click:"",ieclk:!1,mtop:0,mheight:0,pre:!1,item:{bold:'<i class="he-bold"></i>',italic:'<i class="he-italic"></i>',strike:'<i class="he-strike"></i>',underline:'<i class="he-underline"></i>',fontsize:'<i class="he-fontsize"></i>',fontname:'<i class="he-font-2"></i>',color:'<i class="he-font-1"></i>',backcolor:'<i class="he-vkontakte"></i>',center:'<i class="he-align-center"></i>',left:'<i class="he-align-left"></i>',right:'<i class="he-align-right"></i>',full:'<i class="he-align-justify"></i>',indent:'<i class="he-indent-right"></i>',outdent:'<i class="he-indent-left"></i>',link:'<i class="he-link"></i>',unlink:'<i class="he-unlink"></i>',textblock:'<i class="he-imdb"></i>',selectall:'<i class="he-cursor"></i>',removeformat:'<i class="he-check-empty"></i>',image:'<i class="he-picture"></i>',subscript:'<i class="he-subscript"></i>',superscript:'<i class="he-superscript"></i>',horizontal:'<i class="he-minus"></i>',orderedlist:'<i class="he-list-numbered"></i>',unorderedlist:'<i class="he-list-bullet"></i>',cut:'<i class="he-scissors"></i>',copy:'<i class="he-docs"></i>',paste:'<i class="he-paste"></i>',trash:'<i class="he-trash"></i>',undo:'<i class="he-reply"></i>',redo:'<i class="he-forward"></i>',about:'<i class="he-help-circled-alt"></i>'},group:{text:["bold","italic","strike","underline","subscript","superscript","color","backColor"],align:["center","left","right","full","indent","outdent","orderedlist","unorderedlist"],format:["link","unlink","textblock","selectall","removeformat","trash","horizontal"],font:["fontsize","fontname","forecolor"],operate:["cut","copy","paste","about"],multimedia:["image"]},font:{songti:"SimSun",kaiti:"KaiTi",heiti:"SimHei",yahei:"Microsoft YaHei",andalemono:"andale mono",arial:"arial",arialblack:"arial black",comicsansms:"comic sans ms",impact:"impact",timesnewroman:"times new roman"},color:{base:["c00000","ff0000","ffc000","ffff00","92d050","00b050","00b0f0","0070c0","002060","7030a0"],topic:[["ffffff","000000","eeece1","1f497d","4f81bd","c0504d","9bbb59","8064a2","4bacc6","f79646"],["f2f2f2","7f7f7f","ddd9c3","c6d9f0","dbe5f1","f2dcdb","ebf1dd","e5e0ec","dbeef3","fdeada"],["d8d8d8","595959","c4bd97","8db3e2","b8cce4","e5b9b7","d7e3bc","ccc1d9","b7dde8","fbd5b5"],["bfbfbf","3f3f3f","938953","548dd4","95b3d7","d99694","c3d69b","b2a2c7","92cddc","fac08f"],["a5a5a5","262626","494429","17365d","366092","953734","76923c","5f497a","31859b","e36c09"],["7f7f7f","0c0c0c","1d1b10","0f243e","244061","632423","4f6128","3f3151","205867","974806"]]}},getEditor:function(e,i){void 0!==i&&this.extend(this.config,i);var n=this.config.skin;return".css"==n.substr(n.length-4)&&(this.config.skin=n.substr(0,n.length-4)),this.loadcss("skin/"+this.config.skin+".css"),this.loadScript("lang/"+this.config.lang+"/"+this.config.lang+".js",function(){for(var n in lang){var t=HE.trim(n.toLowerCase()),d=lang[n];delete lang[n],lang[t]=d}HE.define.lang=lang,lang=null,HE.handyEditor(e,i)}),this},handyEditor:function(e,i){var n=document.getElementById(e);this.define.id=n.id,n.style.display="none";var t=document.createElement("div");t.className="HandyEditor",t.style.width=this.config.width;var d=document.createElement("div"),o=document.createElement("div");o.id="HandyEditor_menu",o.className="HandyEditor_menu",o.style.position="relative",o.style.outline="none",o.setAttribute("tabindex",0);var a="";for(var l in this.config.item)a+="|"==(s=this.trim(this.config.item[l].toLowerCase()))?'<span class="HandyEditor_menu_gap"></span>':'<span class="HandyEditor_menu_item" id="HandyEditor_'+this.define.id+"_"+s+'" style="display: inline-block;" title="'+this.define.lang[s]+'" draggable="true">'+this.define.item[s]+"</span>";o.innerHTML=a;var r=document.createElement("div");r.className="HandyEditor_editor",r.setAttribute("contenteditable",!0),this.config.autoHeight?(r.style.minHeight=this.config.height,r.style.height="auto",r.style.overflow="hidden"):(r.style.height=this.config.height,r.style.overflow="auto"),this.define.obj=r,t.appendChild(d);var c=document.createElement("div");this.define.mwobj=c,c.appendChild(o),t.appendChild(c),this.define.mobj=o,t.appendChild(r),this.define.hobj=t,heparent=n.parentNode,heparent.insertBefore(t,n),c.style.width=this.define.hobj.clientWidth+"px",this.define.obj.innerHTML=n.value,this.define.hetxt=n;for(var l in this.config.item){var s;"|"!=(s=this.trim(this.config.item[l].toLowerCase()))&&(document.getElementById("HandyEditor_"+this.define.id+"_"+s).onclick=this[s])}this.define.obj.onclick=this.editorClick,this.define.mobj.onclick=this.menukongClick,this.config.autoFloat&&(window.onscroll=function(){document.compatMode&&"BackCompat"!=document.compatMode?HE.define.scrollPos=document.documentElement.scrollTop:document.body&&(HE.define.scrollPos=document.body.scrollTop);var e=HE.getTop(HE.define.hobj)-parseInt(HE.config.topOffset),i=HE.getTop(HE.define.hobj)+HE.define.hobj.offsetHeight-HE.define.mobj.offsetHeight-parseInt(HE.config.topOffset);HE.define.scrollPos>i&&2!=HE.define.mtop?(c.style.position="relative",c.style.top="0px",d.style.height="0px",HE.define.mtop=2):HE.define.scrollPos>e&&HE.define.scrollPos<=i&&1!=HE.define.mtop?(c.style.position="fixed",c.style.top=HE.config.topOffset+"px",0==HE.define.mheight&&(HE.define.mheight=HE.define.mobj.offsetHeight),d.style.height=HE.define.mheight+"px",HE.define.mtop=1):HE.define.scrollPos<=e&&0!=HE.define.mtop&&(c.style.position="relative",c.style.top="0px",d.style.height="0px",HE.define.mtop=0)})},getTop:function(e){for(var i=e.offsetTop;e=e.offsetParent;)i+=e.offsetTop;return i},menukongClick:function(){document.getElementById("HandyEditor_newdiv")&&"HandyEditor_menu"==document.activeElement.id&&HE.deldiv()},extend:function(e,i){for(var n in i)e[n]=i[n];return e},inArray:function(e,i){for(var n=0;n<i.length;n++)if(e===i[n])return!0;return!1},loadScript:function(e,i){var n=document.createElement("script");n.type="text/javascript",void 0!==i&&(n.readyState?n.onreadystatechange=function(){"loaded"!=n.readyState&&"complete"!=n.readyState||(n.onreadystatechange=null,i())}:n.onload=function(){i()}),n.src=e,document.body.appendChild(n)},loadcss:function(e){var i=document.createElement("link");i.type="text/css",i.rel="stylesheet",i.href=e,document.getElementsByTagName("head")[0].appendChild(i)},hasClass:function(e,i){return!!e.className&&e.className.match(new RegExp("(\\s|^)"+i+"(\\s|$)"))},addClass:function(e,i){HE.hasClass(e,i)||(e.className+=" "+i)},removeClass:function(e,i){if(HE.hasClass(e,i)){var n=new RegExp("(\\s|^)"+i+"(\\s|$)");e.className=e.className.replace(n," ")}},ie:function(){return!!(window.ActiveXObject||"ActiveXObject"in window)},getId:function(e){return"HandyEditor_"+this.define.id+"_"+e},findGroup:function(e){for(var i in HE.define.group)if(HE.inArray(e,HE.define.group[i]))return i;return""},editorClick:function(){document.getElementById("HandyEditor_newdiv")&&HE.deldiv(),1==HE.define.pre&&(HE.define.pre=!1),HE.sarea()},abolish:function(){var e=HE.findGroup(HE.define.click);for(var i in HE.define.group[e]){var n=document.getElementById(HE.getId(HE.define.group[e][i]));HE.hasClass(n,"HandyEditor_menu_item_valid")&&(n.click(),HE.removeClass(n,"HandyEditor_menu_item_valid"))}},valid:function(e){var i=document.getElementById(HE.getId(e)),n=!0;if(HE.ie()&&(0==HE.define.ieclk?HE.define.ieclk=!0:(HE.define.ieclk=!1,n=!1)),1==n){HE.mock(i);var t=HE.findGroup(e);if(""!=HE.define.click&&HE.define.click!=e&&!HE.inArray(HE.define.click,HE.define.group[t])){var d=HE.findGroup(HE.define.click);for(var o in HE.define.group[d]){var a=document.getElementById(HE.getId(HE.define.group[d][o]));HE.hasClass(a,"HandyEditor_menu_item_valid")&&HE.removeClass(a,"HandyEditor_menu_item_valid")}}HE.hasClass(i,"HandyEditor_menu_item_valid")?(HE.removeClass(i,"HandyEditor_menu_item_valid"),HE.define.click=""):(HE.addClass(i,"HandyEditor_menu_item_valid"),HE.define.click=e)}},newdiv:function(e){if(HE.define.mobj.blur(),document.getElementById("HandyEditor_newdiv"))HE.deldiv();else{var i=document.getElementById(HE.getId(e)),n=document.createElement("div");if(n.className="HandyEditor_newdiv",n.id="HandyEditor_newdiv","fontsize"==e)for(var t=[14,16,18,24,32,48],d='<div class="HandyEditor_newdiv_down" id="HandyEditor_newdiv_down_1" style="font-size:10px;" draggable="true">'+HE.define.lang.fontsize+"</div>",o=0;o<t.length;o++)d+='<div class="HandyEditor_newdiv_gap"></div><div class="HandyEditor_newdiv_down" id="HandyEditor_newdiv_down_'+(o+2)+'" style="font-size:'+t[o]+'px;" draggable="true">'+HE.define.lang.fontsize+"</div>";else if("fontname"==e){d="";for(var a in HE.define.font)d+=""==d?'<div class="HandyEditor_newdiv_down" id="HandyEditor_newdiv_down_'+a+'" style="font-family:'+HE.define.font[a]+';" draggable="true">'+HE.define.lang[a]+"</div>":'<div class="HandyEditor_newdiv_gap"></div><div class="HandyEditor_newdiv_down" id="HandyEditor_newdiv_down_'+a+'" style="font-family:'+HE.define.font[a]+';" draggable="true">'+HE.define.lang[a]+"</div>"}else if("color"==e){var l=HE.getColor();d="<div>"+HE.define.lang.color+': <input style="border : solid 2px #ddd;padding: 5px;" type="text" id="HandyEditor_newdiv_down_color" /><span class="HandyEditor_menu_item" id="HandyEditor_newdiv_down_colorok" style="display: inline-block;margin-left: 10px;" draggable="true">'+HE.define.lang.affirm+"</span></div><div>"+HE.define.lang.basecolor+'</div><div class="HandyEditor_newdiv_gap"></div><div>'+l[0]+"</div><div>"+HE.define.lang.topicolor+'</div><div class="HandyEditor_newdiv_gap"></div><div>'+l[1]+"</div>"}else"backcolor"==e?(l=HE.getColor(),d="<div>"+HE.define.lang.backcolor+': <input style="border : solid 2px #ddd;padding: 5px;" type="text" id="HandyEditor_newdiv_down_backcolor" /><span class="HandyEditor_menu_item" id="HandyEditor_newdiv_down_backcolorok" style="display: inline-block;margin-left: 10px;" draggable="true">'+HE.define.lang.affirm+"</span></div><div>"+HE.define.lang.basecolor+'</div><div class="HandyEditor_newdiv_gap"></div><div>'+l[0]+"</div><div>"+HE.define.lang.topicolor+'</div><div class="HandyEditor_newdiv_gap"></div><div>'+l[1]+"</div>"):"link"==e?d="<div>"+HE.define.lang.urladdr+': <input style="border : solid 1px #ddd;padding: 5px;" type="text" id="HandyEditor_newdiv_down_link" /><span class="HandyEditor_menu_item" id="HandyEditor_newdiv_down_linkok" style="display: inline-block;margin-left: 10px;" draggable="true">'+HE.define.lang.affirm+"</span></div>":"image"==e?d="<div>"+HE.define.lang.imgaddr+': <input style="border : solid 1px #ddd;padding: 5px;" type="text" id="HandyEditor_newdiv_down_image" /><span class="HandyEditor_menu_item" id="HandyEditor_newdiv_down_imageok" style="display: inline-block;margin-left: 10px;" draggable="true">'+HE.define.lang.affirm+"</span></div>":"about"==e&&(d="<div><h3>HandyEditor</h3>"+HE.define.lang.version+"ï¼š"+HE.define.version+"<p>"+HE.define.lang.cbefore+'<a href="http://www.catfish-cms.com/" target="_blank">Catfish CMS</a>'+HE.define.lang.cafter+"</p></div>");n.innerHTML=d,n.style.top=i.offsetTop+i.offsetHeight+"px",HE.define.mobj.appendChild(n);var r=i.offsetLeft+i.offsetWidth/2-n.offsetWidth/2;if(i.offsetLeft<n.offsetWidth/2&&(r=5),document.body.clientWidth-i.offsetLeft-i.offsetWidth<n.offsetWidth/2&&(r=document.body.clientWidth-n.offsetWidth-5),n.style.left=r+"px",n.onclick=function(){HE.define.mobj.blur()},"fontsize"==e)for(o=1;o<8;o++)document.getElementById("HandyEditor_newdiv_down_"+o).onclick=HE.fontsizeEx;else if("fontname"==e)for(var a in HE.define.font)document.getElementById("HandyEditor_newdiv_down_"+a).onclick=HE.fontnameEx;else if("color"==e){for(var a in HE.define.color.base)document.getElementById("HandyEditor_newdiv_down_colorblock_base_"+HE.define.color.base[a]).onclick=function(){var e=document.getElementById("HandyEditor_newdiv_down_color");e.value="#"+this.title,e.style.borderColor="#"+this.title};for(var a in HE.define.color.topic)for(var o in HE.define.color.topic[a])document.getElementById("HandyEditor_newdiv_down_colorblock_topic_"+a+"_"+HE.define.color.topic[a][o]).onclick=function(){var e=document.getElementById("HandyEditor_newdiv_down_color");e.value="#"+this.title,e.style.borderColor="#"+this.title};document.getElementById("HandyEditor_newdiv_down_colorok").onclick=HE.colorokEx}else if("backcolor"==e){for(var a in HE.define.color.base)document.getElementById("HandyEditor_newdiv_down_colorblock_base_"+HE.define.color.base[a]).onclick=function(){var e=document.getElementById("HandyEditor_newdiv_down_backcolor");e.value="#"+this.title,e.style.borderColor="#"+this.title};for(var a in HE.define.color.topic)for(var o in HE.define.color.topic[a])document.getElementById("HandyEditor_newdiv_down_colorblock_topic_"+a+"_"+HE.define.color.topic[a][o]).onclick=function(){var e=document.getElementById("HandyEditor_newdiv_down_backcolor");e.value="#"+this.title,e.style.borderColor="#"+this.title};document.getElementById("HandyEditor_newdiv_down_backcolorok").onclick=HE.backcolorokEx}else"link"==e?document.getElementById("HandyEditor_newdiv_down_linkok").onclick=HE.linkokEx:"image"==e&&(document.getElementById("HandyEditor_newdiv_down_imageok").onclick=HE.imageokEx)}},getColor:function(){var e="";for(var i in HE.define.color.base)e+='<span id="HandyEditor_newdiv_down_colorblock_base_'+HE.define.color.base[i]+'" class="HandyEditor_newdiv_down_colorblock" style="background-color:#'+HE.define.color.base[i]+'" title="'+HE.define.color.base[i]+'"> </span>';var n="";for(var i in HE.define.color.topic){var t="";for(var d in HE.define.color.topic[i])t+='<span id="HandyEditor_newdiv_down_colorblock_topic_'+i+"_"+HE.define.color.topic[i][d]+'" class="HandyEditor_newdiv_down_colorblock" style="background-color:#'+HE.define.color.topic[i][d]+'" title="'+HE.define.color.topic[i][d]+'"> </span>';n+="<div>"+t+"</div>"}return[e,n]},deldiv:function(){HE.define.mobj.removeChild(document.getElementById("HandyEditor_newdiv"))},sarea:function(e){var i;e=e||!1,window.getSelection?(i=window.getSelection(),e?i.removeAllRanges():HE.define.select=i.getRangeAt(0)):e?(document.body.createTextRange().select(),document.selection.empty()):HE.define.select=document.selection.createRange(),e&&(i.addRange(HE.define.select),HE.define.select=null)},addbr:function(){var e=document.createElement("br");HE.define.obj.appendChild(e)},mock:function(e){HE.ie()&&e.click()},trim:function(e){return e.replace(/(^\s*)|(\s*$)/g,"")},handy:function(e,i){i=i||null,document.execCommand(e,!1,i),HE.define.obj.focus()},getText:function(){return HE.define.obj.innerText},getHtml:function(){return HE.define.obj.innerHTML},sync:function(){this.define.hetxt.value=HE.define.obj.innerHTML},bold:function(){HE.valid("bold"),HE.handy("bold")},italic:function(){HE.valid("italic"),HE.handy("italic")},strike:function(){HE.valid("strike"),HE.handy("strikeThrough")},underline:function(){HE.valid("underline"),HE.handy("underline")},fontsize:function(){HE.newdiv("fontsize")},fontname:function(){HE.newdiv("fontname")},color:function(){HE.sarea(),HE.newdiv("color")},backcolor:function(){HE.sarea(),HE.newdiv("backcolor")},center:function(){HE.handy("justifyCenter")},left:function(){HE.handy("justifyLeft")},right:function(){HE.handy("justifyRight")},full:function(){HE.handy("justifyFull")},indent:function(){HE.handy("indent")},outdent:function(){HE.handy("outdent")},link:function(){HE.sarea(),HE.newdiv("link")},unlink:function(){HE.handy("unlink")},selectall:function(){HE.mock(this),HE.handy("selectAll")},removeformat:function(){HE.abolish(),HE.handy("removeFormat")},image:function(){HE.define.select||(HE.define.obj.focus(),HE.sarea()),HE.newdiv("image")},subscript:function(){HE.valid("subscript"),HE.handy("subscript")},superscript:function(){HE.valid("superscript"),HE.handy("superscript")},horizontal:function(){HE.handy("insertHorizontalRule")},orderedlist:function(){HE.handy("insertOrderedList")},unorderedlist:function(){HE.handy("insertUnorderedList")},undo:function(){HE.handy("undo")},redo:function(){HE.handy("redo")},about:function(){HE.newdiv("about")},fontsizeEx:function(){var e=this.id.split("_");HE.deldiv(),HE.handy("fontSize",parseInt(e[e.length-1]))},fontnameEx:function(){var e=this.id.split("_");HE.deldiv(),HE.handy("fontName",HE.define.font[e[e.length-1]])},cut:function(){HE.handy("cut")},copy:function(){HE.handy("copy")},paste:function(){HE.mock(this),HE.handy("paste")},trash:function(){HE.handy("delete")},linkokEx:function(){var e=document.getElementById("HandyEditor_newdiv_down_link");HE.deldiv(),HE.sarea(!0),HE.handy("createLink",e.value)},imageokEx:function(){var e=document.getElementById("HandyEditor_newdiv_down_image");HE.deldiv(),HE.sarea(!0),HE.handy("insertImage",e.value)},colorokEx:function(){var e=document.getElementById("HandyEditor_newdiv_down_color").value;HE.deldiv(),HE.sarea(!0),HE.handy("foreColor",e)},backcolorokEx:function(){var e=document.getElementById("HandyEditor_newdiv_down_backcolor").value;HE.deldiv(),HE.sarea(!0),HE.handy("backColor",e)},textblock:function(){0==HE.define.pre?(HE.mock(this),HE.handy("formatBlock","<pre>"),HE.define.pre=!0):(HE.addbr(),HE.define.pre=!1)}},HE.loadcss("external/css/HandyEditor.css");}();